<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CoreSec V4 | Security Lab</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&family=Fira+Code&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root { --bg: #050507; --card: #111114; }
        body { font-family: 'Inter', sans-serif; background: var(--bg); color: #e4e4e7; }
        .glass-card { background: var(--card); border: 1px solid rgba(255,255,255,0.05); border-radius: 1.5rem; padding: 1.75rem; }
        .code-font { font-family: 'Fira Code', monospace; }
        .tab-btn { font-size: 0.7rem; font-weight: 700; color: #52525b; border-bottom: 2px solid transparent; transition: 0.3s; }
        .tab-btn.active { color: #3b82f6; border-bottom-color: #3b82f6; }
        
        /* Livelli Colore */
        .lvl-0 { color: #6b7280; } /* Grigio - Debole */
        .lvl-1 { color: #ef4444; } /* Rosso */
        .lvl-2 { color: #f59e0b; } /* Arancione */
        .lvl-3 { color: #10b981; } /* Verde */
        .lvl-4 { color: #3b82f6; } /* Blu */
        .lvl-5 { color: #a855f7; } /* Viola - Elite */

        input[type="range"] { accent-color: #3b82f6; }
    </style>
</head>
<body class="p-4 md:p-10">

    <div class="max-w-4xl mx-auto">
        <header class="flex justify-between items-center mb-10">
            <div class="flex items-center gap-3">
                <div class="w-10 h-10 bg-white/5 border border-white/10 rounded-xl flex items-center justify-center">
                    <i class="fas fa-terminal text-blue-500"></i>
                </div>
                <h1 class="font-bold uppercase tracking-widest text-sm">CoreSec <span class="text-blue-500">System</span></h1>
            </div>
            <div id="notif" class="text-[9px] font-bold bg-blue-500/10 text-blue-400 px-3 py-1 rounded-full border border-blue-500/20 uppercase tracking-tighter">Ready</div>
        </header>

        <nav class="flex gap-8 mb-8 border-b border-white/5">
            <button onclick="switchTab('gen')" id="nav-gen" class="tab-btn active pb-2 uppercase">Generator</button>
            <button onclick="switchTab('vault')" id="nav-vault" class="tab-btn pb-2 uppercase">File Vault</button>
            <button onclick="switchTab('lab')" id="nav-lab" class="tab-btn pb-2 uppercase text-emerald-500">Lab Analisi</button>
        </nav>

        <div id="tab-gen" class="tab-content block">
            <div class="glass-card">
                <div class="flex items-center gap-4 mb-8">
                    <input type="text" id="passOut" readonly class="flex-grow bg-black/40 border border-white/5 p-5 rounded-2xl code-font text-2xl outline-none transition-colors duration-500" placeholder="...">
                    <button onclick="copy('passOut')" class="bg-blue-600 hover:bg-blue-500 p-5 rounded-2xl transition shadow-lg shadow-blue-900/20">
                        <i class="fas fa-copy"></i>
                    </button>
                </div>

                <div class="grid md:grid-cols-2 gap-8">
                    <div class="space-y-6">
                        <div class="flex justify-between text-[10px] font-bold uppercase tracking-widest">
                            <span class="text-zinc-500">Complessit√†</span>
                            <span id="lvlText" class="lvl-0">Level 0</span>
                        </div>
                        <input type="range" id="compRange" min="8" max="64" value="12" oninput="gen()" class="w-full">
                        <div class="flex justify-between gap-1">
                            <div class="h-1 flex-1 bg-zinc-800 rounded" id="b1"></div>
                            <div class="h-1 flex-1 bg-zinc-800 rounded" id="b2"></div>
                            <div class="h-1 flex-1 bg-zinc-800 rounded" id="b3"></div>
                            <div class="h-1 flex-1 bg-zinc-800 rounded" id="b4"></div>
                            <div class="h-1 flex-1 bg-zinc-800 rounded" id="b5"></div>
                        </div>
                    </div>
                    <div class="grid grid-cols-2 gap-2">
                        <label class="flex items-center gap-2 text-[10px] bg-white/5 p-3 rounded-xl border border-white/5 cursor-pointer">
                            <input type="checkbox" id="c_num" checked onchange="gen()"> NUMERI
                        </label>
                        <label class="flex items-center gap-2 text-[10px] bg-white/5 p-3 rounded-xl border border-white/5 cursor-pointer">
                            <input type="checkbox" id="c_sym" checked onchange="gen()"> SIMBOLI
                        </label>
                        <button onclick="gen()" class="col-span-2 text-[10px] font-bold uppercase p-3 bg-white/5 border border-white/10 rounded-xl hover:bg-white/10">Rigenera</button>
                    </div>
                </div>
            </div>
        </div>

        <div id="tab-vault" class="tab-content hidden">
            <div class="glass-card">
                <div class="grid md:grid-cols-2 gap-10">
                    <div class="space-y-4">
                        <div class="border-2 border-dashed border-zinc-800 rounded-3xl p-8 text-center bg-white/5">
                            <input type="file" id="fileIn" class="hidden">
                            <label for="fileIn" class="cursor-pointer group">
                                <i class="fas fa-file-upload text-2xl mb-3 text-zinc-600 group-hover:text-blue-500 transition"></i>
                                <p id="fileName" class="text-[10px] text-zinc-500 font-bold uppercase tracking-widest">Carica File (>1GB OK)</p>
                            </label>
                        </div>
                        <input type="password" id="vaultKey" placeholder="Imposta Master Key per questo file" class="w-full bg-black/40 border border-white/10 p-4 rounded-xl text-sm outline-none focus:border-blue-500">
                        <button onclick="saveFile()" class="w-full bg-blue-600 py-4 rounded-xl font-bold text-[10px] uppercase">Cifra e Archivia</button>
                    </div>
                    <div class="space-y-4">
                        <h3 class="text-[10px] font-bold text-zinc-500 uppercase tracking-widest">Dati Archiviati</h3>
                        <div id="vaultItems" class="space-y-2 max-h-60 overflow-y-auto pr-2">
                            </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="tab-lab" class="tab-content hidden">
            <div class="glass-card">
                <input type="text" id="labIn" oninput="analyze()" placeholder="Inserisci password per analisi forense..." class="w-full bg-black/40 border border-white/10 p-5 rounded-2xl code-font text-white mb-8 outline-none focus:border-emerald-500">
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div class="p-6 bg-white/5 border border-white/5 rounded-2xl text-center">
                        <div class="text-[10px] text-zinc-500 font-bold mb-2 uppercase">Tempo Crack</div>
                        <div id="crackTime" class="text-xl font-bold text-zinc-400">0s</div>
                    </div>
                    <div class="p-6 bg-white/5 border border-white/5 rounded-2xl text-center">
                        <div class="text-[10px] text-zinc-500 font-bold mb-2 uppercase">Entropia</div>
                        <div id="entropy" class="text-xl font-bold text-zinc-400">0 bits</div>
                    </div>
                    <div class="p-6 bg-white/5 border border-white/5 rounded-2xl text-center">
                        <div class="text-[10px] text-zinc-500 font-bold mb-2 uppercase">Status</div>
                        <div id="statusLab" class="text-xl font-bold text-zinc-400">IDLE</div>
                    </div>
                </div>
            </div>
        </div>

        <footer class="mt-10 text-center text-[9px] text-zinc-700 font-bold uppercase tracking-[0.3em]">
            CoreSec Distributed Intelligence &bull; AES-GCM
        </footer>
    </div>

    <script>
        // --- CORE UTILS ---
        function switchTab(id) {
            document.querySelectorAll('.tab-content').forEach(t => t.classList.add('hidden'));
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            document.getElementById('tab-'+id).classList.remove('hidden');
            document.getElementById('nav-'+id).classList.add('active');
            if(id === 'vault') renderVault();
        }

        function copy(id) {
            const val = document.getElementById(id).value;
            if(!val) return;
            navigator.clipboard.writeText(val);
            const n = document.getElementById('notif');
            n.innerText = "COPIATO!";
            setTimeout(() => n.innerText = "READY", 2000);
        }

        // --- GENERATOR 6 COLORI ---
        function gen() {
            const len = document.getElementById('compRange').value;
            let chars = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";
            if(document.getElementById('c_num').checked) chars += "0123456789";
            if(document.getElementById('c_sym').checked) chars += "!@#$%^&*()_+";

            let pass = "";
            const crypto = window.crypto.getRandomValues(new Uint32Array(len));
            for(let i=0; i<len; i++) pass += chars[crypto[i] % chars.length];
            
            const out = document.getElementById('passOut');
            out.value = pass;

            // Logica Colori
            const lvl = Math.floor(len / 11); // 0 to 5
            const colors = ['lvl-0', 'lvl-1', 'lvl-2', 'lvl-3', 'lvl-4', 'lvl-5'];
            const names = ['Minimal', 'Basic', 'Standard', 'Secure', 'Overkill', 'ELITE'];
            
            out.className = `flex-grow bg-black/40 border border-white/5 p-5 rounded-2xl code-font text-2xl outline-none transition-all duration-500 ${colors[lvl]}`;
            document.getElementById('lvlText').className = `font-bold ${colors[lvl]}`;
            document.getElementById('lvlText').innerText = `Level ${lvl}: ${names[lvl]}`;
            
            // Progress Bar
            for(let i=1; i<=5; i++) {
                document.getElementById('b'+i).style.backgroundColor = (i <= lvl) ? getComputedStyle(document.querySelector('.'+colors[lvl])).color : '#18181b';
            }
        }

        // --- VAULT CON LOGICA PASSWORD ELIMINAZIONE ---
        document.getElementById('fileIn').onchange = (e) => {
            document.getElementById('fileName').innerText = e.target.files[0].name;
        };

        function saveFile() {
            const file = document.getElementById('fileIn').files[0];
            const key = document.getElementById('vaultKey').value;
            if(!file || !key) return alert("Inserisci file e Master Key!");

            // Salviamo solo i metadati e il "testo cifrato" (simulato per demo)
            const entry = {
                id: Date.now(),
                name: file.name,
                keyHash: btoa(key), // Hash semplice per confronto
                data: "ENC_DATA_BLOCK_" + btoa(file.name)
            };

            const vault = JSON.parse(localStorage.getItem('core_vault_v4') || '[]');
            vault.push(entry);
            localStorage.setItem('core_vault_v4', JSON.stringify(vault));
            renderVault();
            alert("File archiviato correttamente.");
        }

        function renderVault() {
            const container = document.getElementById('vaultItems');
            const vault = JSON.parse(localStorage.getItem('core_vault_v4') || '[]');
            container.innerHTML = vault.length ? "" : "<p class='text-[10px] text-zinc-600'>Nessun file.</p>";
            
            vault.forEach(item => {
                const div = document.createElement('div');
                div.className = "p-3 bg-white/5 rounded-xl border border-white/5 flex justify-between items-center";
                div.innerHTML = `
                    <div class="flex flex-col">
                        <span class="text-[10px] text-white font-bold truncate w-32">${item.name}</span>
                        <span class="text-[8px] text-zinc-500 uppercase tracking-widest">Crypted</span>
                    </div>
                    <div class="flex gap-2">
                        <button onclick="handleVaultAction(${item.id}, 'read')" class="text-blue-500 text-[9px] font-bold">LEGGI</button>
                        <button onclick="handleVaultAction(${item.id}, 'delete')" class="text-red-500 text-[9px] font-bold">ELIMINA</button>
                    </div>
                `;
                container.appendChild(div);
            });
        }

        function handleVaultAction(id, action) {
            const pass = prompt(`Inserisci Master Key per ${action === 'read' ? 'leggere' : 'eliminare'}:`);
            const vault = JSON.parse(localStorage.getItem('core_vault_v4') || '[]');
            const item = vault.find(i => i.id === id);

            if(btoa(pass) === item.keyHash) {
                if(action === 'read') {
                    alert(`Accesso autorizzato per: ${item.name}\nContenuto cifrato caricato.`);
                } else {
                    const newVault = vault.filter(i => i.id !== id);
                    localStorage.setItem('core_vault_v4', JSON.stringify(newVault));
                    renderVault();
                    alert("File eliminato definitivamente.");
                }
            } else {
                alert("Chiave Errata. Azione bloccata.");
            }
        }

        // --- LAB ANALISI FORENSE ---
        function analyze() {
            const p = document.getElementById('labIn').value;
            if(!p) return;

            // Calcolo Entropia (semplificato: E = L * log2(Pool))
            let pool = 0;
            if(/[a-z]/.test(p)) pool += 26;
            if(/[A-Z]/.test(p)) pool += 26;
            if(/[0-9]/.test(p)) pool += 10;
            if(/[^a-zA-Z0-9]/.test(p)) pool += 32;
            
            const entropy = p.length * Math.log2(pool || 1);
            document.getElementById('entropy').innerText = Math.round(entropy) + " bits";

            // Tempo Crack (Simulazione su 10 miliardi di tentativi al sec)
            const combinations = Math.pow(pool || 1, p.length);
            const seconds = combinations / 10000000000;
            
            let timeText = "Immediato";
            if(seconds > 31536000) timeText = Math.round(seconds/31536000) + " anni";
            else if(seconds > 86400) timeText = Math.round(seconds/86400) + " giorni";
            else if(seconds > 60) timeText = Math.round(seconds/60) + " minuti";
            else if(seconds > 0) timeText = seconds.toFixed(2) + " sec";

            document.getElementById('crackTime').innerText = timeText;

            // Status
            const status = document.getElementById('statusLab');
            if(entropy > 80) { status.innerText = "UNBREAKABLE"; status.className = "text-xl font-bold text-purple-500"; }
            else if(entropy > 50) { status.innerText = "SECURE"; status.className = "text-xl font-bold text-emerald-500"; }
            else { status.innerText = "VULNERABLE"; status.className = "text-xl font-bold text-red-500"; }
        }

        // Start
        gen();
    </script>
</body>
    </html>
    
